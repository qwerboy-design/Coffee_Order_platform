# 圖片上傳功能驗證清單

## 🎯 測試目標
驗證圖片上傳功能已完全修復並可正常運作

## 📝 驗證步驟

### 階段 1: 環境準備 ✅

- [x] 開發伺服器已啟動 (npm run dev)
- [x] 可訪問 http://localhost:3000
- [ ] 已登入系統（如需要）

### 階段 2: Storage 配置檢查

訪問：http://localhost:3000/test-upload

#### 2.1 執行自動檢查
- [ ] 點擊「執行 Storage 檢查」按鈕
- [ ] 等待檢查完成（約 2-5 秒）

#### 2.2 驗證檢查結果
- [ ] 總體狀態顯示：✅ SUCCESS
- [ ] 環境變數檢查：✅ 通過
- [ ] Buckets 列表：✅ 通過
- [ ] Products Bucket：✅ 通過
- [ ] 上傳測試：✅ 通過
- [ ] 公開 URL 測試：✅ 通過
- [ ] 清理測試檔案：✅ 通過

**如果有任何項目失敗，請參考 `docs/UPLOAD_SUMMARY.md` 的故障排除章節**

### 階段 3: 圖片上傳測試

#### 3.1 準備測試圖片
準備 1-3 張測試圖片：
- [ ] 格式：PNG、JPG、GIF 或 WebP
- [ ] 大小：小於 5MB
- [ ] 建議使用不同格式測試

#### 3.2 執行上傳
- [ ] 點擊上傳區域
- [ ] 選擇第一張圖片
- [ ] 觀察上傳過程

#### 3.3 驗證上傳過程
- [ ] 顯示載入動畫（旋轉圖示）
- [ ] 上傳完成後動畫消失
- [ ] 顯示成功訊息：「圖片上傳成功！」

#### 3.4 驗證上傳結果
- [ ] 圖片預覽正確顯示
- [ ] 圖片清晰無損
- [ ] 顯示刪除按鈕（hover 時可見）
- [ ] 計數器更新：「已上傳 1 / 5 張圖片」

#### 3.5 驗證公開 URL
- [ ] 在「上傳成功的圖片 URL」區塊中看到 URL
- [ ] URL 格式正確（https://...supabase.co/storage/...）
- [ ] 點擊 URL 可在新分頁開啟圖片
- [ ] 圖片在新分頁中正常顯示

#### 3.6 測試多張上傳
- [ ] 上傳第二張圖片
- [ ] 上傳第三張圖片
- [ ] 所有圖片都正確顯示
- [ ] 計數器正確更新

#### 3.7 測試刪除功能
- [ ] Hover 到圖片上
- [ ] 看到紅色刪除按鈕
- [ ] 點擊刪除按鈕
- [ ] 圖片從列表中移除
- [ ] 計數器正確更新

### 階段 4: 錯誤處理測試

#### 4.1 測試檔案類型驗證
- [ ] 嘗試上傳非圖片檔案（如 .txt、.pdf）
- [ ] 顯示錯誤訊息：「無效的檔案類型，僅支援圖片格式」

#### 4.2 測試檔案大小限制
- [ ] 嘗試上傳超過 5MB 的圖片
- [ ] 顯示錯誤訊息：「檔案大小超過 5MB 限制」

#### 4.3 測試數量限制
- [ ] 上傳 5 張圖片（達到上限）
- [ ] 嘗試上傳第 6 張
- [ ] 顯示錯誤訊息：「最多只能上傳 5 張圖片」

### 階段 5: 控制台日誌檢查

開啟瀏覽器開發者工具 (F12) > Console

#### 5.1 上傳成功時的日誌
應該看到類似以下的日誌：
```
[Upload] File info: { name: "...", type: "image/...", size: ... }
[Upload] Uploading to path: uploads/...
[Upload] Buffer size: ...
[Upload] Upload successful: { ... }
[Upload] Public URL: https://...
```

#### 5.2 驗證日誌內容
- [ ] 檔案資訊正確
- [ ] 上傳路徑包含 `uploads/` 前綴
- [ ] Buffer 大小與檔案大小一致
- [ ] 上傳成功訊息
- [ ] 公開 URL 有效

#### 5.3 檢查錯誤（應該沒有）
- [ ] 沒有紅色錯誤訊息
- [ ] 沒有警告訊息（黃色）
- [ ] 沒有網路請求失敗

### 階段 6: 實際使用場景測試

#### 6.1 在產品管理中測試
- [ ] 前往產品管理頁面
- [ ] 創建或編輯產品
- [ ] 使用 ImageUpload 元件上傳產品圖片
- [ ] 儲存產品
- [ ] 重新載入頁面
- [ ] 確認圖片正確顯示

## 📊 測試結果

### 通過標準
所有以下項目都必須通過：

✅ **核心功能**
- [ ] Storage 檢查全部通過
- [ ] 可以成功上傳圖片
- [ ] 圖片預覽正確顯示
- [ ] 獲得有效的公開 URL

✅ **錯誤處理**
- [ ] 檔案類型驗證正常
- [ ] 檔案大小驗證正常
- [ ] 數量限制驗證正常
- [ ] 錯誤訊息清晰友善

✅ **用戶體驗**
- [ ] 上傳過程流暢
- [ ] 載入狀態明確
- [ ] 成功反饋即時
- [ ] 刪除功能正常

✅ **技術品質**
- [ ] 沒有控制台錯誤
- [ ] 日誌資訊完整
- [ ] 網路請求成功
- [ ] 效能表現良好

## 🐛 問題記錄

如果發現任何問題，請記錄：

### 問題 1
- **描述：** 
- **重現步驟：** 
- **預期行為：** 
- **實際行為：** 
- **錯誤訊息：** 
- **截圖：** 

### 問題 2
- **描述：** 
- **重現步驟：** 
- **預期行為：** 
- **實際行為：** 
- **錯誤訊息：** 
- **截圖：** 

## ✅ 最終確認

- [ ] 所有測試項目都已完成
- [ ] 所有核心功能正常運作
- [ ] 沒有發現嚴重問題
- [ ] 已記錄所有發現的問題
- [ ] 準備好部署到生產環境

## 📅 測試資訊

- **測試日期：** _______________
- **測試人員：** _______________
- **環境：** Development
- **瀏覽器：** _______________
- **測試結果：** ⭕ 通過 / ❌ 失敗

## 📝 備註

_______________________________________________
_______________________________________________
_______________________________________________

---

**參考文檔：**
- 完整修復報告：`docs/IMAGE_UPLOAD_FIX.md`
- 測試指南：`docs/UPLOAD_TEST_GUIDE.md`
- 總結報告：`docs/UPLOAD_SUMMARY.md`
